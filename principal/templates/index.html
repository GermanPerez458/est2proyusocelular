<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Análisis Estadístico | Requiem Engine</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            },
            startup: {
                pageReady: () => {
                    return MathJax.startup.defaultPageReady().then(() => {
                        console.log('MathJax inicial listo');
                    });
                }
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">

    <style>
        :root {
            --elephant-50: #edfdfe;
            --elephant-300: #72dcee;
            --elephant-400: #32c4de;
            --elephant-500: #16a7c4;
            --elephant-700: #186c86;
            --elephant-900: #1c4a5d;
            --elephant-950: #0e3546;
        }
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(rgba(14, 53, 70, 0.94), rgba(14, 53, 70, 0.94)), url('https://www.transparenttextures.com/patterns/dark-matter.png'), #0e3546;
            color: var(--elephant-50);
            min-height: 100vh;
        }
        .glass-card { 
            background: rgba(14, 53, 70, 0.7); 
            backdrop-filter: blur(12px); 
            border: 1px solid rgba(172, 237, 245, 0.1); 
            border-radius: 16px; 
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }
        .btn-primary { 
            background: linear-gradient(135deg, var(--elephant-500), var(--elephant-700)); 
            transition: all 0.3s ease; 
            color: white; 
            box-shadow: 0 4px 15px rgba(22, 167, 196, 0.3);
        }
        .btn-primary:hover:not(:disabled) { transform: translateY(-2px); filter: brightness(1.1); }
        .input-dark { background: rgba(0, 0, 0, 0.2); border: 1px solid var(--elephant-700); color: white; }
        
        mjx-container { color: var(--elephant-300) !important; font-size: 1.1em !important; }
        
        .hidden { display: none; }
        
        #alert-container { position: fixed; top: 20px; right: 20px; z-index: 9999; display: flex; flex-direction: column; gap: 10px; }
        .alert-requiem { padding: 1rem 2rem; border-radius: 8px; animation: slideIn 0.3s ease-out; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); }
        .alert-success { background: rgba(22, 167, 196, 0.9); }
        .alert-error { background: rgba(220, 38, 38, 0.9); }
        
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        
        .desarrollo-pasos-container {
            overflow-x: auto;
            scrollbar-width: thin;
        }
        
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.2);
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: var(--elephant-700);
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: var(--elephant-500);
        }
    </style>
</head>
<body class="pb-20">

<div id="alert-container"></div>

<header class="bg-elephant-950/80 sticky top-0 z-50 border-b border-elephant-700 mb-10 backdrop-blur-md">
    <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
        <div>
            <h1 class="text-2xl font-bold tracking-tight text-white uppercase">USO O<span class="text-elephant-400"> ABUSO DEL CELULAR</span></h1>
            <p class="text-[10px] text-elephant-500 uppercase tracking-[0.3em]">Requiem Statistics Engine v3.5</p>
        </div>
        <div id="loadingIndicator" class="hidden">
            <div class="flex items-center gap-3 bg-elephant-900/50 px-4 py-2 rounded-full border border-elephant-400/30">
                <div class="w-3 h-3 border-2 border-elephant-400 border-t-transparent rounded-full animate-spin"></div>
                <span class="text-[10px] font-bold text-elephant-400 uppercase tracking-widest">Calculando</span>
            </div>
        </div>
    </div>
</header>

<main class="max-w-6xl mx-auto px-6">
    <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
        <div class="glass-card p-8 border-b-2 border-transparent hover:border-elephant-400 transition-colors">
            <h2 class="text-sm font-bold mb-4 flex items-center gap-2 uppercase tracking-wider text-elephant-300">
                <span class="bg-elephant-400/20 p-1 rounded">01</span> Carga de Datos CSV
            </h2>
            <input type="file" id="csvFile" accept=".csv" class="input-dark w-full px-4 py-2 rounded-lg text-xs mb-4 file:mr-4 file:py-1 file:px-4 file:rounded-full file:border-0 file:text-[10px] file:font-bold file:bg-elephant-400 file:text-elephant-950 hover:file:bg-elephant-300 cursor-pointer">
            <div id="vista-previa" class="hidden text-[10px] bg-black/40 p-3 rounded border border-white/5 mb-4 font-mono text-elephant-300"></div>
            <p class="text-[10px] text-elephant-500 mb-4 italic">* El archivo debe contener una columna numérica de horas.</p>
        </div>

        <div class="glass-card p-8 border-b-2 border-transparent hover:border-purple-400 transition-colors">
            <h2 class="text-sm font-bold mb-4 flex items-center gap-2 uppercase tracking-wider text-purple-300">
                <span class="bg-purple-400/20 p-1 rounded">02</span> Simulación Gamma
            </h2>
            <div class="grid grid-cols-3 gap-3 mb-4">
                <div>
                    <label class="block text-[9px] uppercase mb-1 text-elephant-400 font-bold">Muestra (n)</label>
                    <input type="number" id="nEjemplo" value="100" class="input-dark w-full p-2 rounded text-sm outline-none focus:border-purple-400">
                </div>
                <div>
                    <label class="block text-[9px] uppercase mb-1 text-elephant-400 font-bold">Media</label>
                    <input type="number" id="mediaEjemplo" value="5.5" step="0.1" class="input-dark w-full p-2 rounded text-sm outline-none focus:border-purple-400">
                </div>
                <div>
                    <label class="block text-[9px] uppercase mb-1 text-elephant-400 font-bold">Std Dev</label>
                    <input type="number" id="desvEjemplo" value="1.2" step="0.1" class="input-dark w-full p-2 rounded text-sm outline-none focus:border-purple-400">
                </div>
            </div>
            <button onclick="app.generarEjemplo()" class="bg-purple-600/20 border border-purple-500/50 hover:bg-purple-600/40 w-full py-3 rounded-lg text-[10px] font-bold uppercase tracking-widest transition-all">Generar Muestra de Control</button>
        </div>
    </section>

    <section class="glass-card p-8 mb-12 border-l-4 border-elephant-400">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 items-end">
            <div>
                <label class="block text-[10px] font-bold text-elephant-400 uppercase mb-2 tracking-widest">Umbral Crítico ($\mu_0$)</label>
                <input type="number" id="input-umbral" value="5" step="0.5" class="input-dark w-full px-4 py-3 rounded-lg focus:ring-1 focus:ring-elephant-400 outline-none text-sm">
            </div>
            <div>
                <label class="block text-[10px] font-bold text-elephant-400 uppercase mb-2 tracking-widest">Confianza ($1 - \alpha$)</label>
                <select id="nivel-confianza" class="input-dark w-full px-4 py-3 rounded-lg focus:ring-1 focus:ring-elephant-400 outline-none text-sm cursor-pointer">
                    <option value="0.90">90% Confianza</option>
                    <option value="0.95" selected>95% Confianza</option>
                    <option value="0.99">99% Confianza</option>
                </select>
            </div>
            <div class="md:col-span-2">
                <button id="btn-analizar" disabled onclick="app.ejecutarAnalisis()" class="btn-primary w-full py-3.5 rounded-lg font-bold uppercase tracking-[0.2em] text-[11px] shadow-lg disabled:opacity-50 disabled:cursor-not-allowed">
                    Ejecutar Inferencia Completa
                </button>
            </div>
        </div>

        <div class="mt-8 border-t border-white/5 pt-4">
            <button id="btnPreview" class="text-[10px] font-bold uppercase tracking-widest text-cyan-400 hover:text-cyan-300 transition flex items-center gap-2">
                <span>▶ Ver datos crudos cargados</span>
            </button>
            
            <div id="previewDatos" class="hidden mt-4 rounded-md bg-black/40 p-4 border border-cyan-900/50 max-h-64 overflow-auto custom-scrollbar">
            </div>
        </div>
    </section>

    <div id="contenedor-analisis" class="space-y-10 min-h-[300px]">
        <div class="text-center py-20 opacity-20 border-2 border-dashed border-elephant-700 rounded-2xl" id="esperando">
            <p class="font-mono text-sm tracking-widest uppercase">Esperando flujo de datos...</p>
        </div>
    </div>
</main>

<footer class="mt-20 py-10 border-t border-white/5 text-center bg-black/20">
    <div class="max-w-6xl mx-auto px-6 flex flex-col md:flex-row justify-between items-center gap-4 text-elephant-500 text-[9px] uppercase tracking-widest">
        <p>© 2026 FACULTAD DE CIENCIAS PURAS Y NATURALES - PROYECTO ESTADÍSTICA 2</p>
        <p class="font-mono text-elephant-600">Diddy Party Team // Build 3.5.0-Final</p>
    </div>
</footer>

<script src="{{ url_for('static', filename='js/app.js') }}"></script>

</body>
</html>

